---

title: 在LaTex中排版数学公式
categories: [计算机, 排版]
tags: [latex, 数学]
authors: [badbadyi]
math: true

---

## 宏包

AMS 宏集合是美国数学学会提供的对 LaTex 原生的数学公式排版的扩展，其核心是 `amsmath` 宏包

本文默认已经引用 `amsmath` 宏包

```latex
\usepackage{amsmath}
```

## 排版

### 行内公式

使用一对 `$` 包裹的公式为行内公式，会与文字混排

```latex
勾股定理公式的公式是
$a^2 + b^2 = c^2$
```

如上，公式会与文字排列在同行

### 行间公式

通过 `equation` 环境来包裹单独成行的行间公式

```latex
勾股定理公式的公式是：
\begin{equation}
a^2 + b^2 = c^2
\end{equation}
它有悠久的历史
```

默认的 `equation` 环境会为公式生成一个编号，可以通过 `\label` 和 `\ref` 来生成引用

将 `\ref` 替换为 `\eqref` 来为引用加上括号

```latex
勾股定理公式的公式是：
\begin{equation}
a^2 + b^2 = c^2 \label{gougu}
\end{equation}
它 \ref{gougu} 有悠久的历史 \\
它 \eqref{gougu} 有悠久的历史
```

通过 `\tag` 可以手动修改公式编号（引用时也会显示该编号）

通过 `\notag` 移除自动生成的公式编号

```latex
判断表达式是否正确：\\
第一个表达式
\begin{equation}
1 + 1 = 3 \label{exp 1} \tag{wrong}
\end{equation}
第二个表达式
\begin{equation}
1 + 1 = 2 \notag
\end{equation}
第一个表达式 \eqref{exp 1} 是错误的
```

如果不希望为公式生成编号，有如下三种方法

- `\[` 和 `\]`

  不使用任何环境，将公式直接用 `\[` 和 `\]` 包裹

- `displaymath` 环境

  直接使用 `displaymath` 环境

- `equation*` 环境

  使用带星号的 `equation*` 环境，与不带星号的环境作出区别

```latex
第一种方式
\[ a^2 + b^2 = c^2 \]
第二种方式
\begin{displaymath}
a^2 + b^2 = c^2
\end{displaymath}
第三种方式
\begin{equation*}
a^2 + b^2 = c^2
\end{equation*}
```

### 数学模式

以上所有方式会使 LaTex 进入数学模式，数学模式下

- **空格被忽略**

  符号间的间距由符号自身的特性决定

  需要引入间隔时，使用 `\quad` 或 `\qquad` 等命令

- **不允许空行或分段**

  例如 `\\` 的换行或是普通的回车都会导致报错

  若需要公式换行需要使用其他的环境

- 特殊的排版模式

  如果希望再公式中插入少量文本，可以使用 `\text` 或 `\textbf` 命令（由 `amsmath` 提供）

  *过多的文字请使用行内公式，而不是滥用这个命令*

  ```latex
  $a^2 + b^2 = c^2 \quad \text{勾股定理}$
  ```

## 数学符号

### 一般符号

- 希腊字母符号即其英文名称

  例如 $\alpha$ 即 `\alpha` 、$\beta$ 即 `\beta`

- 大写希腊字母是首字母大写的命令

  例如 $\Gamma$ 即 `\Gamma` 、$\Delta$ 即 `\Delta`

- 无穷大 $\infty$

  `\infty`

- 省略号

  省略号有 $\dots$ 和 $\cdots$ 两种形式

  分别是 `\dots` 和 `\cdots`

可以查表来查询需要使用的符号

### 指数、上下标和导数

用 `^` 标明上标，用 `_` 标明下标

该符号只对符号后第一个字符有用，如果需要包含子表达式作为上下标应使用 `{}` 包裹

```latex
$a^x+y \neq a^{x+y}
```

如上代码可以表示 $a^x+y \neq a^{x+y}$

用 `'` 表示导数符号，连用以表示多阶导数，可以在其后连用上标

```latex
$f(x) = x^2 \quad f'(x) = 2x \quad f''^{2}(x) = 4$
```

如上代码可以表示 $f(x) = x^2 \quad f'(x) = 2x \quad f''^{2}(x) = 4$

### 分式和根式

用 `\frac{分子}{分母}` 来书写分式

行间公式中的分式是正常大小，在行内公式中则会被极度压缩

通过 `amsmath` 提供的 `\dfrac` 和 `tfrac` 来在行内公式中获得正常大小的分式

```latex
行间公式：
\[
3/8 \qquad \frac{3}{8}
\qquad \tfrac{3}{8}
\]
行内公式：
$1\frac{1}{2}$~hours \qquad
$1\dfrac{1}{2}$~hours
```

用 `\sqrt{...}` 来书写普通的二次根号，例如 `\sqrt{123}` 表示 $\sqrt{123}$

用 `\sqrt[n]{...}` 来书写 n 次方的根号，例如 `\sqrt[3]{123}` 表示 $\sqrt[3]{123}$

```latex
$\sqrt{x} \Leftrightarrow x^{1/2}
\quad \sqrt[3]{2}
\quad \sqrt{x^{2} + \sqrt{y}}$
```

用 `\binom` 来书写二项式结构的分式，例如 `\binom{1}{2}` 表示 $\binom{1}{2}$

```latex
帕斯卡法则：
\[
\binom{n}{k} =\binom{n-1}{k}
+ \binom{n-1}{k-1}
\]
```

### 关系符

`=` 、`>` 和 `<` 直接输入即可

`\ne` 表示 $\ne$

`\ge` 表示 $\\ge$，  `\le` 表示 $\le$

`\approx` 表示 $\approx$，`\equiv` 表示 $\equiv$

`\propto` 表示 $\propto$，`\sim` 表示 $\sim$

### 其他符号

通过该[页面](https://oeis.org/wiki/List_of_LaTeX_mathematical_symbols)来查找你需要的数学符号

## 多行公式

### 单公式折行

对于过长的单个长公式，使用 `mutiline` 环境来换行

在该环境中，你可以使用 `\\` 来换行

```latex
\begin{multline}
a + b + c + d + e + f
+ g + h + i \\
= j + k + l + m + n\\
= o + p + q + r + s\\
= t + u + v + x + z
\end{multline}
```

多行公式的首行左对齐，中间行居中，末行右对齐

使用带星号 `*` 的 `multline*` 来避免产生公式编号

### 多公式对齐

通过使用 `align` 环境，使用 `\\` 来换行，并用 `&` 来标记需要对齐的位置

*通常将 `&` 放到等号左边*

```latex
\begin{align}
a & = b + c \\
& = d + e
\end{align}
```

`align` 环境会给每行公式都编号，使用 `\notag` 来去除某一行公式的编号

*通常将 `&` 放到等号右边，通过一对括号`{}`来产生正常间距*

```latex
\begin{align}
a ={} & b + c \\
={} & d + e + f + g + h + i
+ j + k + l \notag \\
& + m + n + o \\
={} & p + q + r + s
\end{align}
```

`align` 也可以对齐多组公式，除了等号前的 `&` ，公式之间也能用 `&` 分隔

```latex
\begin{align}
a &=1  & b &=2  & c &=3	\\
d &=-1 & e &=-2 & f &=-5
\end{align}
```

### 多公式罗列

当不需要对齐多公式，而只需要罗列时，使用 `gather` 环境

```latex
\begin{gather}
a = b + c \\
d = e + f + g \\
h + i = j + k \notag \\
l + m = n
\end{gather}
```

### 多公式公用编号

通过上面的环境加上 `-ed` 结尾，例如 `aligned` 、`gathered` 等环境与 `equation` 套用

```latex
\begin{equation}
\begin{aligned}
a &= b + c \\
d &= e + f + g \\
h + i &= j + k \\
l + m &= n
\end{aligned}
\end{equation}
```

## 数组和矩阵

### 数组

下面是一个二维数组的示例

```latex
\[ \mathbf{X} = \left(
\begin{array}{cccc}
x_{11} & x_{12} & \ldots & x_{1n}\\
x_{21} & x_{22} & \ldots & x_{2n}\\
\vdots & \vdots & \ddots & \vdots\\
x_{n1} & x_{n2} & \ldots & x_{nn}\\
\end{array} \right) \]
```

$$X = \left(
\begin{array}{cccc}
x_{11} & x_{12} & \ldots & x_{1n}\\
x_{21} & x_{22} & \ldots & x_{2n}\\
\vdots & \vdots & \ddots & \vdots\\
x_{n1} & x_{n2} & \ldots & x_{nn}\\
\end{array} \right)$$

其中，使用 `array` 环境来构建主体部分，`cccc` 指定格式，代表主体有四列

主体中，通过 `&` 控制对齐，通过 `\\` 控制换行

`\ldots` 为横向省略点，`\vdots` 为纵向省略号，`\ddots` 为斜向省略号

`array` 环境左右通过定界符 `\left` 和 `\right` 来确定主体两边的括号

### 分情况公式

通过 `cases` 环境来实现分情况发生的公式

*等于使用  `array` 环境左定界符括号，右定界符空*

```latex
\[ |x| =
\begin{cases}
-x & \text{if } x < 0,\\
0 & \text{if } x = 0,\\
x & \text{if } x > 0.
\end{cases} \]
```

### 矩阵

`amsmath` 提供了许多排版矩阵的环境

不带定界符的 `matrix` ，`pmatrix` `(` ，`bmatrix` `[`， `Bmatrix` `{` ，`vmatrix` `|`，`Vmatrix` `||`

使用这些环境时，无需指定格式

```latex
\[
\begin{matrix}
1 & 2 \\ 3 & 4
\end{matrix} \qquad
\begin{bmatrix}
x_{11} & x_{12} & \ldots & x_{1n}\\
x_{21} & x_{22} & \ldots & x_{2n}\\
\vdots & \vdots & \ddots & \vdots\\
x_{n1} & x_{n2} & \ldots & x_{nn}\\
\end{bmatrix}
\]
```

在矩阵元素中排版分式时，需要使用 `\dfrac` 

```latex
\[
\mathbf{H}=
\begin{bmatrix}
\dfrac{\partial^2 f}{\partial x^2} &
\dfrac{\partial^2 f}
{\partial x \partial y} \\[8pt]
\dfrac{\partial^2 f}
{\partial x \partial y} &
\dfrac{\partial^2 f}{\partial y^2}
\end{bmatrix}
\]
```

## 字体控制

### 字体

```latex
\[
\begin{array}{c}
\mathnormal{ABCDEabcde1234} \\
\mathrm{ABCDEabcde1234} \\
\mathit{ABCDEabcde1234} \\
\mathbf{ABCDEabcde1234} \\
\mathsf{ABCDEabcde1234} \\
\mathtt{ABCDEabcde1234} \\
\mathcal{ABCDE} \\
\mathscr{ABCDE} \\
\mathfrak{ABCDEabcde1234} \\
\mathbb{ABCDE}
\end{array}
\]
```

其中变量为 `ABCDE` 的说明该字体仅提供大写字母

`\mathcal` 分为两种，默认和 `eucal` 提供

`\mathfrak` 由 `amssymb` 或 `eufrak` 提供

`\mathscr` 由 `mathrsfs` 提供

`\maathbb` 由 `amssymb` 提供 

### 加粗

通过 `\mathbf` 获得直立加粗的字母

通过 `\boldsymbol` 获得斜体加粗的字母

```latex
$\mu, M \qquad \boldsymbol{\mu}, \boldsymbol{M}$
```

通过 `bm` 包提供的 `\bm` 获得粗糙的粗体，在字母本身没有斜粗体的情况下选择使用

```latex
$\mu, M \qquad \bm{\mu}, \bm{M}$
```

## 定理

### LaTex自带

```latex
\newtheorem{<环境命名>}{<标题>}[<分区等级>]
\newtheorem{<环境命名>}[<计数器>]{<标题>}
```

```latex
\newtheorem{mythm}{My Theorem}[section]
\begin{mythm}\label{thm:light}
The light speed in vacuum
is $299,792,458\,\mathrm{m/s}$.
\end{mythm}
\begin{mythm}[Energy-momentum relation]
The relationship of energy,
momentum and mass is
\[E^2 = m_0^2 c^4 + p^2 c^2\]
where $c$ is the light speed
described in theorem \ref{thm:light}.
\end{mythm}
```

### amsthm宏包

```latex
\theoremstyle{definition} \newtheorem{law}{Law}
\theoremstyle{plain} \newtheorem{jury}[law]{Jury}
\theoremstyle{remark} \newtheorem*{mar}{Margaret}
```

```latex
\begin{law}\label{law:box}
Don't hide in the witness box.
\end{law}
\begin{jury}[The Twelve]
It could be you! So beware and
see law~\ref{law:box}.\end{jury}
\begin{jury}
You will disregard the last
statement.\end{jury}
\begin{mar}No, No, No\end{mar}
\begin{mar}Denis!\end{mar}
```

### 证明和证毕

```latex
\begin{proof}
For simplicity, we use
\[
E=mc^2
\]
That's it.
\end{proof}
```

```latex
\begin{proof}
For simplicity, we use
\[
E=mc^2 \qedhere
\]
\end{proof}
```

```latex
\begin{proof}
Assuming $\gamma
= 1/\sqrt{1-v^2/c^2}$, then
\begin{align*}
E &= \gamma m_0 c^2
\\
p &= \gamma m_0v \qedhere
\end{align*}
\end{proof}
```

```latex
\begin{proof}
For simplicity, we use
\begin{equation}
E=mc^2.\qedhere
\end{equation}
\end{proof}
```

```latex
\renewcommand{\qedsymbol}%
{\rule{1ex}{1.5ex}}
\begin{proof}
For simplicity, we use
\[
E=mc^2 \qedhere
\]
\end{proof}
```

